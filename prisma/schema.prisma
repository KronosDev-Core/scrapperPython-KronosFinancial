datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-py"
  binaryTargets = ["native", "darwin"]
}

enum Status {
  NEW
  UPDATED
  NOT_CHANGED
}

enum BuyStatus {
  PENDING
  BUY
  SOLD
}

model Stock {
  id       String     @id @default(auto()) @map("_id") @db.ObjectId
  symbol   String     @unique
  name     String
  sector   String
  price    Float
  status   Status
  dividend Dividend[]
}

model Dividend {
  id               String   @id @default(auto()) @map("_id") @db.ObjectId
  dateExDividend   DateTime
  datePayment      DateTime
  dividendPerShare Float
  status           Status
  stockSymbol      String
  stock            Stock    @relation(fields: [stockSymbol], references: [symbol])
  buy              Buy[]
}

model Buy {
  id         String    @id @default(auto()) @map("_id") @db.ObjectId
  date       DateTime
  price      Float
  amount     Float
  status     BuyStatus
  sell       Sell?
  dividendId String    @db.ObjectId
  dividend   Dividend  @relation(fields: [dividendId], references: [id])
}

model Sell {
  id    String   @id @default(auto()) @map("_id") @db.ObjectId
  date  DateTime
  price Float
  buyId String   @unique @db.ObjectId
  buy   Buy      @relation(fields: [buyId], references: [id])
}
